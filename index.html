<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="FuelMaster — приложение для управления расходом топлива, отслеживания автомобилей и получения советов. Скачайте для Android и iOS!">
    <meta name="keywords" content="FuelMaster, расход топлива, калькулятор, автомобили, Flutter, Android, iOS">
    <meta name="author" content="maksimyugov89">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://maksimyugov89.github.io/FuelMaster_web/">
    <meta property="og:title" content="FuelMaster - Калькулятор расхода топлива">
    <meta property="og:description" content="Управляй расходом топлива с умом. Комплексное приложение для отслеживания автомобилей и экономии топлива.">
    <meta property="og:image" content="https://maksimyugov89.github.io/FuelMaster_web/assets/img/icon-512.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://maksimyugov89.github.io/FuelMaster_web/">
    <meta property="twitter:title" content="FuelMaster - Калькулятор расхода топлива">
    <meta property="twitter:description" content="Управляй расходом топлива с умом">
    <meta property="twitter:image" content="https://maksimyugov89.github.io/FuelMaster_web/assets/img/icon-512.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://maksimyugov89.github.io/FuelMaster_web/">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="FuelMaster">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="assets/img/icon-152.png">
    <link rel="apple-touch-icon" sizes="152x152" href="assets/img/icon-152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/img/icon-192.png">
    <link rel="apple-touch-icon" sizes="192x192" href="assets/img/icon-192.png">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/icon-96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/img/icon-96.png">
    <link rel="shortcut icon" href="assets/img/icon-96.png">
    
    <title>FuelMaster - Калькулятор расхода топлива</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="assets/css/styles.css" as="style">
    <link rel="preload" href="assets/js/script.js" as="script">
    
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- SEO JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "FuelMaster",
      "description": "Калькулятор расхода топлива и управление автомобилями",
      "url": "https://maksimyugov89.github.io/FuelMaster_web/",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "author": {
        "@type": "Person",
        "name": "maksimyugov89"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "RUB"
      }
    }
    </script>
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Перейти к основному содержанию</a>
    
    <header role="banner">
        <div class="container">
            <div class="header-content">
                <h1 class="brand-title">FuelMaster</h1>
                <div class="header-utils">
                    <div class="weather-info" id="weather-info" aria-live="polite" aria-label="Информация о погоде">
                        <i class="fas fa-cloud" aria-hidden="true"></i> 
                        <span class="weather-loading">Загрузка...</span>
                    </div>
                    <label for="language-toggle" class="sr-only">Выберите язык</label>
                    <select id="language-toggle" aria-label="Переключение языка">
                        <option value="ru">RU</option>
                        <option value="en">EN</option>
                    </select>
                    <button id="theme-toggle" aria-label="Переключить тему" aria-pressed="false">
                        <span id="theme-text"></span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main id="main-content" role="main">
        <section id="hero" aria-labelledby="hero-title">
            <div class="parallax-bg" aria-hidden="true"></div>
            <div class="particles" aria-hidden="true"></div>
            <div class="container">
                <h1 id="hero-title" data-i18n="hero-title">Управляй расходом топлива с умом</h1>
                <p id="hero-subtitle" data-i18n="hero-subtitle">FuelMaster — комплексное приложение для отслеживания автомобилей, расчета топлива и полезных советов.</p>
                <a href="#download" class="btn primary" aria-describedby="download-description">
                    <i class="fas fa-download animated-icon" aria-hidden="true"></i> 
                    <span id="download-text" data-i18n="download-text">Скачать</span>
                </a>
                <div class="seasonal-banner" id="seasonal-banner" data-i18n="seasonal-banner" role="banner" aria-live="polite">
                    Осенние обновления 2025: Улучшенный расчет и новые советы по экономии до 30 сентября! 
                    <span id="countdown" aria-live="polite"></span>
                </div>
            </div>
        </section>

        <section id="calculator" aria-labelledby="calculator-title">
            <div class="container">
                <h2 id="calculator-title" data-i18n="calculator-title">Рассчитайте расход топлива</h2>
                <form class="calculator-form" novalidate aria-live="polite">
                    <div class="input-group">
                        <label for="start-mileage" class="sr-only">Начальный пробег в километрах</label>
                        <input type="number" id="start-mileage" placeholder="Начальный пробег (км)" 
                               min="0" step="0.1" data-i18n="start-mileage" 
                               aria-describedby="start-mileage-error" required>
                        <span id="start-mileage-error" class="error-message" role="alert"></span>
                    </div>
                    
                    <div class="input-group">
                        <label for="end-mileage" class="sr-only">Конечный пробег в километрах</label>
                        <input type="number" id="end-mileage" placeholder="Конечный пробег (км)" 
                               min="0" step="0.1" data-i18n="end-mileage" 
                               aria-describedby="end-mileage-error" required>
                        <span id="end-mileage-error" class="error-message" role="alert"></span>
                    </div>
                    
                    <div class="input-group">
                        <label for="start-fuel" class="sr-only">Количество топлива в литрах</label>
                        <input type="number" id="start-fuel" placeholder="Топливо в баке на начало (л)" 
                               min="0" step="0.1" data-i18n="start-fuel" 
                               aria-describedby="start-fuel-error" required>
                        <span id="start-fuel-error" class="error-message" role="alert"></span>
                    </div>
                    
                    <div class="input-group">
                        <label for="highway-km" class="sr-only">Километры по трассе</label>
                        <input type="number" id="highway-km" placeholder="Км по трассе" 
                               min="0" step="0.1" data-i18n="highway-km">
                        <span id="highway-km-error" class="error-message" role="alert"></span>
                    </div>

                    <div class="input-group">
                        <label for="fuel-price" class="sr-only">Цена топлива за литр</label>
                        <input type="number" id="fuel-price" placeholder="Цена топлива (руб/л)" 
                               min="0" step="0.1" data-i18n="fuel-price">
                        <span id="fuel-price-error" class="error-message" role="alert"></span>
                    </div>
                    
                    <button type="button" id="calculate-btn" data-i18n="calculate-btn" 
                            aria-describedby="calculation-result">Рассчитать</button>
                    
                    <div id="calculation-result" aria-live="polite">
                        <p id="total-mileage" class="result-text"></p>
                        <p id="result" class="result-text"></p>
                        <p id="cost-result" class="result-text"></p>
                    </div>
                </form>
            </div>
        </section>

        <section id="features" aria-labelledby="features-title">
            <div class="container">
                <h2 id="features-title" data-i18n="features-title">Основные возможности</h2>
                <div class="feature-grid">
                    <article class="feature-card">
                        <i class="fas fa-car animated-icon" aria-hidden="true"></i>
                        <h3 id="feature1-title" data-i18n="feature1-title">Управление авто</h3>
                        <p id="feature1-desc" data-i18n="feature1-desc">Добавление, редактирование, удаление автомобилей с базой моделей из CSV.</p>
                    </article>
                    <article class="feature-card">
                        <i class="fas fa-gas-pump animated-icon" aria-hidden="true"></i>
                        <h3 id="feature2-title" data-i18n="feature2-title">Расчет расхода</h3>
                        <p id="feature2-desc" data-i18n="feature2-desc">Учет города/трассы, погоды, кондиционера и других факторов.</p>
                    </article>
                    <article class="feature-card">
                        <i class="fas fa-chart-line animated-icon" aria-hidden="true"></i>
                        <h3 id="feature3-title" data-i18n="feature3-title">История и графики</h3>
                        <p id="feature3-desc" data-i18n="feature3-desc">Хранение, фильтры и визуализация с fl_chart.</p>
                    </article>
                    <article class="feature-card">
                        <i class="fas fa-lock animated-icon" aria-hidden="true"></i>
                        <h3 id="feature4-title" data-i18n="feature4-title">Безопасность и премиум</h3>
                        <p id="feature4-desc" data-i18n="feature4-desc">Firebase вход, синхронизация с Firestore для премиум.</p>
                    </article>
                </div>
            </div>
        </section>

        <section id="screenshots" aria-labelledby="screenshots-title">
            <div class="container">
                <h2 id="screenshots-title" data-i18n="screenshots-title">Скриншоты</h2>
                <div class="gallery" id="screenshot-gallery" role="group" aria-label="Галерея скриншотов приложения">
                    <img src="assets/img/Screenshot-1-dark.jpg" alt="Скриншот главного экрана приложения FuelMaster" 
                         loading="lazy" data-light="assets/img/Screenshot-1-light.jpg" data-dark="assets/img/Screenshot-1-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-2-dark.jpg" alt="Скриншот калькулятора расхода топлива" 
                         loading="lazy" data-light="assets/img/Screenshot-2-light.jpg" data-dark="assets/img/Screenshot-2-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-3-dark.jpg" alt="Скриншот списка автомобилей" 
                         loading="lazy" data-light="assets/img/Screenshot-3-light.jpg" data-dark="assets/img/Screenshot-3-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-4-dark.jpg" alt="Скриншот добавления нового автомобиля" 
                         loading="lazy" data-light="assets/img/Screenshot-4-light.jpg" data-dark="assets/img/Screenshot-4-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-5-dark.jpg" alt="Скриншот истории поездок" 
                         loading="lazy" data-light="assets/img/Screenshot-5-light.jpg" data-dark="assets/img/Screenshot-5-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-6-dark.jpg" alt="Скриншот графиков расхода топлива" 
                         loading="lazy" data-light="assets/img/Screenshot-6-light.jpg" data-dark="assets/img/Screenshot-6-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-7-dark.jpg" alt="Скриншот настроек приложения" 
                         loading="lazy" data-light="assets/img/Screenshot-7-light.jpg" data-dark="assets/img/Screenshot-7-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-8-dark.jpg" alt="Скриншот профиля пользователя" 
                         loading="lazy" data-light="assets/img/Screenshot-8-light.jpg" data-dark="assets/img/Screenshot-8-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-9-dark.jpg" alt="Скриншот советов по экономии топлива" 
                         loading="lazy" data-light="assets/img/Screenshot-9-light.jpg" data-dark="assets/img/Screenshot-9-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-10-dark.jpg" alt="Скриншот уведомлений" 
                         loading="lazy" data-light="assets/img/Screenshot-10-light.jpg" data-dark="assets/img/Screenshot-10-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-11-dark.jpg" alt="Скриншот экспорта данных" 
                         loading="lazy" data-light="assets/img/Screenshot-11-light.jpg" data-dark="assets/img/Screenshot-11-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                    <img src="assets/img/Screenshot-12-dark.jpg" alt="Скриншот темной темы приложения" 
                         loading="lazy" data-light="assets/img/Screenshot-12-light.jpg" data-dark="assets/img/Screenshot-12-dark.jpg" 
                         tabindex="0" role="button" aria-label="Открыть изображение в полном размере">
                </div>
            </div>
        </section>

        <section id="testimonials" aria-labelledby="testimonials-title">
            <div class="container">
                <h2 id="testimonials-title" data-i18n="testimonials-title">Отзывы пользователей</h2>
                <div class="testimonial-grid">
                    <article class="testimonial-card">
                        <blockquote>
                            <p id="testimonial1-text" data-i18n="testimonial1-text">"Отлично помогает экономить топливо!"</p>
                            <cite id="testimonial1-author" data-i18n="testimonial1-author">— Иван, Москва</cite>
                        </blockquote>
                        <div class="stars" aria-label="Рейтинг: 5 из 5 звезд">★★★★★</div>
                    </article>
                    <article class="testimonial-card">
                        <blockquote>
                            <p id="testimonial2-text" data-i18n="testimonial2-text">"Простое и удобное приложение!"</p>
                            <cite id="testimonial2-author" data-i18n="testimonial2-author">— Ольга, Санкт-Петербург</cite>
                        </blockquote>
                        <div class="stars" aria-label="Рейтинг: 4 из 5 звезд">★★★★☆</div>
                    </article>
                </div>
            </div>
        </section>

        <section id="download" aria-labelledby="download-title">
            <div class="container">
                <h2 id="download-title" data-i18n="download-title">Скачай FuelMaster</h2>
                <p id="download-desc" data-i18n="download-desc">Доступно для Android и iOS. Установи прямо сейчас!</p>
                <div class="download-buttons">
                    <a href="https://github.com/maksimyugov89/FuelMaster" class="btn secondary" 
                       data-i18n="download-github" target="_blank" rel="noopener noreferrer"
                       aria-label="Перейти к исходному коду на GitHub">
                        <img src="assets/img/icon-96.png" alt="" class="download-logo" aria-hidden="true"> 
                        <span>Исходный код</span>
                    </a>
                    <a href="#" class="btn primary" data-i18n="download-apk" 
                       aria-label="Скачать APK файл приложения">
                        <img src="assets/img/icon-96.png" alt="" class="download-logo" aria-hidden="true"> 
                        <span>Скачать APK</span>
                    </a>
                </div>
            </div>
        </section>
    </main>

    <footer role="contentinfo">
        <div class="container">
            <p>&copy; 2025 FuelMaster | 
                <a href="https://github.com/maksimyugov89" target="_blank" rel="noopener noreferrer" 
                   aria-label="Профиль разработчика на GitHub">
                    <i class="fab fa-github" aria-hidden="true"></i> maksimyugov89
                </a>
            </p>
            <a href="https://t.me/Satir45" target="_blank" rel="noopener noreferrer" 
               aria-label="Связаться в Telegram">
                <i class="fab fa-telegram" aria-hidden="true"></i> Telegram
            </a>
        </div>
    </footer>

    <!-- Modal -->
    <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-backdrop" aria-hidden="true"></div>
        <div class="modal-content" role="document">
            <div class="modal-header">
                <h3 id="modal-title" class="sr-only">Просмотр изображения</h3>
                <button class="close-modal" aria-label="Закрыть модальное окно">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <button class="carousel-btn prev" aria-label="Предыдущее изображение">
                    <span aria-hidden="true">&#10094;</span>
                </button>
                <img id="modal-img" src="" alt="Увеличенное изображение" tabindex="0">
                <button class="carousel-btn next" aria-label="Следующее изображение">
                    <span aria-hidden="true">&#10095;</span>
                </button>
            </div>
            <div class="modal-footer">
                <p id="modal-caption"></p>
            </div>
        </div>
    </div>

    <!-- Loading indicator -->
    <div id="loading" class="loading-overlay" aria-hidden="true">
        <div class="spinner" aria-label="Загрузка..."></div>
    </div>

    <!-- Error notification -->
    <div id="error-notification" class="error-notification" role="alert" aria-live="assertive" aria-hidden="true">
        <p id="error-message"></p>
        <button class="error-close" aria-label="Закрыть уведомление">&times;</button>
    </div>

    <!-- PWA Install Banner -->
    <div id="install-banner" class="install-banner" style="display: none;">
        <div class="install-content">
            <img src="assets/img/icon-96.png" alt="FuelMaster" class="install-icon">
            <div class="install-text">
                <h3>Установить FuelMaster</h3>
                <p>Получите быстрый доступ к приложению</p>
            </div>
            <div class="install-buttons">
                <button id="install-btn" class="btn primary">Установить</button>
                <button id="dismiss-btn" class="btn secondary">Позже</button>
            </div>
        </div>
    </div>

    <script src="assets/js/script.js"></script>
    
    <!-- Register Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/FuelMaster_web/sv.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
                
                // Обработчик сообщений от Service Worker
                navigator.serviceWorker.addEventListener('message', event => {
                    const { type, online, version } = event.data || {};
                    
                    switch (type) {
                        case 'CONNECTIVITY_CHANGED':
                            const status = online ? 'Подключение восстановлено' : 'Работаем в оффлайн режиме';
                            console.log('Статус соединения:', status);
                            
                            // Показываем уведомление пользователю
                            if (window.fuelMasterApp && window.fuelMasterApp.showError) {
                                window.fuelMasterApp.showError(status);
                            }
                            break;
                            
                        case 'SW_READY':
                            console.log('Service Worker готов, версия:', version);
                            break;
                    }
                });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        const installBanner = document.getElementById('install-banner');
        const installBtn = document.getElementById('install-btn');
        const dismissBtn = document.getElementById('dismiss-btn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Показываем баннер установки если не был установлен ранее
            if (!localStorage.getItem('pwa-dismissed')) {
                installBanner.style.display = 'block';
            }
        });

        // Обработчик кнопки установки
        if (installBtn) {
            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    
                    if (outcome === 'accepted') {
                        console.log('PWA установлено');
                    } else {
                        console.log('Установка PWA отклонена');
                    }
                    
                    deferredPrompt = null;
                    installBanner.style.display = 'none';
                }
            });
        }

        // Обработчик кнопки "Позже"
        if (dismissBtn) {
            dismissBtn.addEventListener('click', () => {
                installBanner.style.display = 'none';
                localStorage.setItem('pwa-dismissed', 'true');
                // Показывать снова через 7 дней
                setTimeout(() => {
                    localStorage.removeItem('pwa-dismissed');
                }, 7 * 24 * 60 * 60 * 1000);
            });
        }

        // Обработчик успешной установки
        window.addEventListener('appinstalled', () => {
            console.log('PWA установлено успешно');
            installBanner.style.display = 'none';
            localStorage.setItem('pwa-installed', 'true');
            
            // Показываем уведомление об успешной установке
            if (window.fuelMasterApp && window.fuelMasterApp.showError) {
                window.fuelMasterApp.showError('Приложение успешно установлено!');
            }
        });

        // Проверка уже установленного PWA
        if (window.matchMedia('(display-mode: standalone)').matches) {
            console.log('PWA запущено в standalone режиме');
            localStorage.setItem('pwa-installed', 'true');
        }
    </script>

    <!-- Стили для PWA Install Banner -->
    <style>
        .install-banner {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #007bff, #00c4cc);
            color: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 90vw;
            animation: slideUp 0.3s ease-out;
        }

        .install-content {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            gap: 15px;
        }

        .install-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
        }

        .install-text h3 {
        margin: 0 0 5px 0;
        font-size: 16px;
        font-weight: 600;
    }

    .install-text p {
        margin: 0;
        font-size: 14px;
        opacity: 0.9;
    }

    .install-buttons {
        display: flex;
        gap: 10px;
    }

    .install-buttons .btn {
        padding: 8px 16px;
        font-size: 14px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .install-buttons .btn.primary {
        background: rgba(255, 255, 255, 0.2);
        color: white;
    }

    .install-buttons .btn.secondary {
        background: rgba(255, 255, 255, 0.1);
        color: white;
    }

    .install-buttons .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    @keyframes slideUp {
        from {
            transform: translateX(-50%) translateY(100%);
            opacity: 0;
        }
        to {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
    }

    @media (max-width: 768px) {
        .install-content {
            padding: 12px 15px;
            gap: 10px;
        }
    
        .install-icon {
            width: 40px;
            height: 40px;
        }
    
        .install-buttons .btn {
            padding: 6px 12px;
            font-size: 12px;
        }
    }
    </style>
    </body>
    </html>
